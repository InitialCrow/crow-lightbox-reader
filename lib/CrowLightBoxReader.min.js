"use strict"
function _interopRequireDefault(e){return e&&e.__esModule?e:{default:e}}function _classCallCheck(e,t){if(!(e instanceof t))throw new TypeError("Cannot call a class as a function")}function _possibleConstructorReturn(e,t){if(!e)throw new ReferenceError("this hasn't been initialised - super() hasn't been called")
return!t||"object"!=typeof t&&"function"!=typeof t?e:t}function _inherits(e,t){if("function"!=typeof t&&null!==t)throw new TypeError("Super expression must either be null or a function, not "+typeof t)
e.prototype=Object.create(t&&t.prototype,{constructor:{value:e,enumerable:!1,writable:!0,configurable:!0}}),t&&(Object.setPrototypeOf?Object.setPrototypeOf(e,t):e.__proto__=t)}Object.defineProperty(exports,"__esModule",{value:!0})
var _createClass=function(){function e(e,t){for(var o=0;o<t.length;o++){var r=t[o]
r.enumerable=r.enumerable||!1,r.configurable=!0,"value"in r&&(r.writable=!0),Object.defineProperty(e,r.key,r)}}return function(t,o,r){return o&&e(t.prototype,o),r&&e(t,r),t}}(),_react=require("react"),_react2=_interopRequireDefault(_react)
require("./CrowLightBoxReader.css")
var CrowLightBoxReader=function(e){function t(e){_classCallCheck(this,t)
var o=_possibleConstructorReturn(this,(t.__proto__||Object.getPrototypeOf(t)).call(this,e))
return o.poolItems=e.items||[],o.isRead=e.isRead||0,o.closeCallBack=e.closeCallBack||!1,o.settings=e.settings||{},o.showPool=o.settings.showPool||!0,o.showBtn=o.settings.showBtn||!0,o.showCloseBtn=o.settings.showCloseBtn||!0,o.showDesc=o.settings.showDesc||!0,o.showPagination=o.settings.showPagination||!0,o.nodeToHide=o.settings.nodeToHide||!1,o.showLightBox=o.settings.showLightBox||!1,o.debug=o.settings.debug||!1,o.nodes={thumb:[],desc:null},o.state={changeItem:!1},o}return _inherits(t,e),_createClass(t,[{key:"console",value:function(e){function t(){return e.apply(this,arguments)}return t.toString=function(){return e.toString()},t}(function(){var e=arguments.length>0&&void 0!==arguments[0]?arguments[0]:""
!1!==this.debug&&console.log(e)})},{key:"componentDidMount",value:function(){!1!==this.showLightBox&&(document.body.classList.add("crow-lightbox-reader-bg"),this.nodes.desc.style.maxWidth=this.poolItems[this.isRead].width+"px",this.nodes.thumb[this.isRead].classList.add("current"))}},{key:"deleteBody",value:function(){if(!1!==this.nodeToHide){var e=document.getElementById(this.nodeToHide).childNodes
console.log(e)
for(var t=0;t<e.length;t++)void 0!=e[t].classList&&e[t].classList.add("crow-hide")}}},{key:"closeLightBox",value:function(){!1!==this.closeCallBack&&!1!==this.showLightBox&&this.closeCallBack(),!1!==this.showLightBox&&(document.body.classList.remove("crow-lightbox-reader-bg"),this.showLightBox=!1,this.setState({renderItem:!1}))}},{key:"changeItem",value:function(e){this.nodes.thumb[this.isRead].classList.remove("current"),this.isRead=e,this.nodes.thumb[this.isRead].classList.add("current"),this.setState({renderItem:!0})}},{key:"changeNextItem",value:function(){this.isRead<this.poolItems.length-1&&(this.nodes.thumb[this.isRead].classList.remove("current"),this.isRead++,this.nodes.thumb[this.isRead].classList.add("current"),this.setState({renderItem:!0}))}},{key:"changePrevItem",value:function(){this.isRead>0&&(this.nodes.thumb[this.isRead].classList.remove("current"),this.isRead--,this.nodes.thumb[this.isRead].classList.add("current"),this.setState({renderItem:!0}))}},{key:"renderPagination",value:function(){if(!1!==this.showPagination){var e=this.isRead+1,t=this.poolItems.length
return _react2.default.createElement("p",{className:"crow-lightbox-reader-pagination"},e," / ",t)}}},{key:"renderDesc",value:function(){var e=this,t=arguments.length>0&&void 0!==arguments[0]?arguments[0]:""
if(!1!==this.showDesc)return null!==this.nodes.desc&&(this.nodes.desc.style.maxWidth=t.width+"px"),_react2.default.createElement("p",{ref:function(t){e.nodes.desc=t},className:"crow-lightbox-reader-desc"},t.desc)}},{key:"renderCloseBtn",value:function(){var e=this
if(!1!==this.showCloseBtn)return _react2.default.createElement("span",{className:"lightbox-close-btn",onClick:function(){e.closeLightBox()}},"❌")}},{key:"renderBtn",value:function(){var e=this
if(!1!==this.showBtn)return _react2.default.createElement("div",null,_react2.default.createElement("div",{className:"crow-lightbox-reader-prev",onClick:function(){e.changePrevItem()}},_react2.default.createElement("p",{className:"lightbox-btn"},"❰")),_react2.default.createElement("div",{className:"crow-lightbox-reader-next",onClick:function(){e.changeNextItem()}},_react2.default.createElement("p",{className:"lightbox-btn"},"❯")))}},{key:"renderVideoItemThumb",value:function(){var e=this,t=arguments.length>0&&void 0!==arguments[0]?arguments[0]:"",o=arguments[1]
return"video"===t.type?_react2.default.createElement("li",{onClick:function(){e.changeItem(o)},ref:function(t){e.nodes.thumb.push(t)},key:o.toString(),className:"pool-item"},_react2.default.createElement("video",{src:t.src,width:t.thumbWidth,height:t.thumbHeight,onPlay:function(e){e.preventDefault()}})):""==t.type||void 0==t.type?void this.console("Bug on CrowLightBoxReader => renderVideoItemThumb func || you need to write type ('video', 'image', 'song') property in items pool "):void 0}},{key:"renderImageItemThumb",value:function(){var e=this,t=arguments.length>0&&void 0!==arguments[0]?arguments[0]:"",o=arguments[1]
return"image"===t.type?_react2.default.createElement("li",{onClick:function(){e.changeItem(o)},ref:function(t){e.nodes.thumb.push(t)},key:o.toString(),className:"pool-item"},_react2.default.createElement("img",{src:t.src,width:t.thumbWidth,height:t.thumbHeight,alt:t.alt})):""==t.type||void 0==t.type?void this.console("Bug on CrowLightBoxReader => renderImageItemThumb func || you need to write type ('video', 'image', 'song') property in items pool "):void 0}},{key:"renderAudioItemThumb",value:function(){var e=this,t=arguments.length>0&&void 0!==arguments[0]?arguments[0]:"",o=arguments[1]
return"audio"===t.type?_react2.default.createElement("li",{onClick:function(){e.changeItem(o)},ref:function(t){e.nodes.thumb.push(t)},key:o.toString(),className:"pool-item"},_react2.default.createElement("img",{src:t.thumbSrc,width:t.thumbWidth,height:t.thumbHeight,alt:"thumbnail of audio content"})):""==t.type||void 0==t.type?void this.console("Bug on CrowLightBoxReader => renderAudioItemThumb func || you need to write type ('video', 'image', 'song') property in items pool "):void 0}},{key:"renderItem",value:function(){var e=arguments.length>0&&void 0!==arguments[0]?arguments[0]:""
return"video"===e.type?_react2.default.createElement("div",{className:"render-content"},this.renderDesc(e),this.renderBtn(),_react2.default.createElement("video",{width:e.width,height:e.height,src:e.src,autoPlay:!0,controls:!0}),this.renderPagination()):"audio"===e.type?_react2.default.createElement("div",{className:"render-content"},this.renderDesc(e),this.renderBtn(),_react2.default.createElement("img",{width:e.width,height:e.height,src:e.thumbSrc,alt:"image of song reader"}),_react2.default.createElement("audio",{className:"audio",src:e.src,autoPlay:!0,controls:!0}),this.renderPagination()):"image"===e.type?_react2.default.createElement("div",{className:"render-content"},this.renderDesc(e),this.renderBtn(),_react2.default.createElement("img",{width:e.width,height:e.height,className:"render-content",src:e.src,alt:e.alt}),this.renderPagination()):""==e||void 0==e.type?void this.console("Bug on CrowLightBoxReader => renderItemRender func || you need to write type ('video', 'image', 'song') property in items pool "):void 0}},{key:"renderItemRenderer",value:function(){return _react2.default.createElement("div",{key:"r0",className:"crow-lightbox-reader-render"},this.renderItem(this.poolItems[this.isRead]))}},{key:"renderPoolItemsThumb",value:function(){var e=this
if(""!=this.poolItems){var t=[]
return this.poolItems.map(function(o,r){void 0!==e.renderVideoItemThumb(o,r)&&t.push(e.renderVideoItemThumb(o,r)),void 0!==e.renderImageItemThumb(o,r)&&t.push(e.renderImageItemThumb(o,r)),void 0!==e.renderAudioItemThumb(o,r)&&t.push(e.renderAudioItemThumb(o,r))}),t}return void this.console("Bug on CrowLightBoxReader => renderPoolItemsThumb func || you need to pass not empty items into items props on lightbox")}},{key:"renderPoolListThumb",value:function(){if(!1!==this.showPool)return _react2.default.createElement("ul",{key:"r1",className:"crow-lightbox-reader-pool-list"},this.renderPoolItemsThumb())}},{key:"showRenderer",value:function(){if(!1!==this.showLightBox){this.deleteBody()
var e=[]
return e.push(this.renderItemRenderer()),e.push(this.renderPoolListThumb()),_react2.default.createElement("div",{className:"crow-lightbox-reader"},this.renderCloseBtn(),e)}return null}},{key:"render",value:function(){return this.showRenderer()}}]),t}(_react.Component)
exports.default=CrowLightBoxReader
